# ุฏููู ุชุญุณูู ุงูุฃุฏุงุก - ูุธุงู ุฅุฏุงุฑุฉ ุดุฑูุฉ ุงูุชูุธูู ุงูููุฒูู
# Performance Optimization Guide - Home Cleaning Management System

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุญุณูู ุงููุธุงู ููุชุนุงูู ูุน ุงูุจูุงูุงุช ุงูุถุฎูุฉ (ูุฆุงุช ุงูุขูุงู ูู ุงูุณุฌูุงุช) ูุน ุงูุญูุงุธ ุนูู ุงูุฃุฏุงุก ุงูุนุงูู ูุงูุงุณุชูุฑุงุฑ.

## ๐ ุงูุชุญุณููุงุช ุงููุทุจูุฉ

### 1. ุชุญุณููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### ุงูููุงุฑุณ ุงููุถุงูุฉ:
- **ููุงุฑุณ ุงูุทูุจุงุช**: `idx_orders_status_date`, `idx_orders_customer_scheduled`, `idx_orders_team_date`
- **ููุงุฑุณ ุงูุนููุงุก**: `idx_customers_search_text`, `idx_customers_phone`, `idx_customers_area`
- **ููุงุฑุณ ุงูุนูุงู**: `idx_workers_status`, `idx_workers_skills`, `idx_workers_rating`
- **ููุงุฑุณ ุงููุตุฑููุงุช**: `idx_expenses_date_team`, `idx_expenses_status`

#### Views ูุญุณูุฉ:
- `v_orders_summary`: ููุฎุต ุงูุทูุจุงุช ุจุฏูู JOIN ูุนูุฏุฉ
- `v_daily_stats`: ุฅุญุตุงุฆูุงุช ููููุฉ ูุญุณูุฉ
- `v_team_performance`: ุฃุฏุงุก ุงููุฑู ุงููุญุณู

#### Materialized Views:
- `mv_monthly_stats`: ุฅุญุตุงุฆูุงุช ุดูุฑูุฉ
- `mv_top_customers`: ุฃูุถู ุงูุนููุงุก

### 2. ุชุญุณููุงุช ุงูููุฏ ุงูุจุฑูุฌู

#### API ูุญุณูุฉ:
- **Orders API**: ุงุณุชุฎุฏุงู Views + ุชุญููู ุชุฏุฑูุฌู ููุชูุงุตูู
- **Customers API**: ุงุณุชุนูุงูุงุช ูููุตูุฉ ููุนุฏุฏ + ููุฑุณุฉ ุงูุจุญุซ
- **Reports API**: ุงุณุชุฎุฏุงู Materialized Views

#### ุฃุฏูุงุช ุงูุฃุฏุงุก:
- **Performance Monitor**: ูุฑุงูุจุฉ ุงูุงุณุชุนูุงูุงุช ุงูุจุทูุฆุฉ
- **Cache Manager**: ุชุฎุฒูู ูุคูุช ุฐูู
- **Batch Processor**: ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุจุงูุฏูุนุงุช
- **Connection Manager**: ุฅุฏุงุฑุฉ ุงูุงุชุตุงูุงุช

## ๐ ุชููุนุงุช ุชุญุณูู ุงูุฃุฏุงุก

| ุงูุนูููุฉ | ูุจู ุงูุชุญุณูู | ุจุนุฏ ุงูุชุญุณูู | ุงูุชุญุณู |
|---------|-------------|-------------|--------|
| ุชุญููู ุงูุทูุจุงุช (100 ุณุฌู) | 2-5 ุซูุงูู | 200-500ms | 80-90% |
| ุงูุจุญุซ ูู ุงูุนููุงุก | 1-3 ุซูุงูู | 100-300ms | 85-90% |
| ุงูุชูุงุฑูุฑ ุงูููููุฉ | 10-30 ุซุงููุฉ | 1-3 ุซูุงูู | 90-95% |
| ุชุญููู ููุญุฉ ุงูุชุญูู | 5-15 ุซุงููุฉ | 500ms-2s | 85-95% |

## ๐ง ุฎุทูุงุช ุงูุชุทุจูู

### ุงูุฎุทูุฉ 1: ุชุทุจูู ุชุญุณููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช

```sql
-- ุชุดุบูู ุงูุณูุฑูุจุช ูู Supabase SQL Editor
-- ููู: database-performance-optimization.sql
```

**โ๏ธ ุชูุจูู ููู**: 
- ูู ุจุชุดุบูู ุงูุณูุฑูุจุช ุฎูุงู ุณุงุนุงุช ุงูุฐุฑูุฉ ุงูููุฎูุถุฉ
- ุงูุณูุฑูุจุช ูุณุชุฎุฏู `CONCURRENTLY` ูุชุฌูุจ ููู ุงูุฌุฏุงูู
- ูุฏ ูุณุชุบุฑู 10-30 ุฏูููุฉ ุญุณุจ ุญุฌู ุงูุจูุงูุงุช

### ุงูุฎุทูุฉ 2: ุงุณุชุฎุฏุงู API ุงููุญุณูุฉ

#### ูุจู ุงูุชุญุณูู:
```typescript
// ุงูุทุฑููุฉ ุงููุฏููุฉ
const orders = await OrdersAPI.getOrders(filters, page, limit);
```

#### ุจุนุฏ ุงูุชุญุณูู:
```typescript
// ุงูุทุฑููุฉ ุงููุญุณูุฉ
import { Orders } from './api/optimized-api';

// ุชุญููู ุฃุณุงุณู ุณุฑูุน
const orders = await Orders.getOrders(filters, page, limit, false);

// ุชุญููู ูุน ุงูุชูุงุตูู ุนูุฏ ุงูุญุงุฌุฉ
const ordersWithDetails = await Orders.getOrders(filters, page, limit, true);
```

### ุงูุฎุทูุฉ 3: ูุฑุงูุจุฉ ุงูุฃุฏุงุก

```typescript
import { Performance, Health } from './api/optimized-api';

// ูุญุต ุตุญุฉ ุงููุธุงู
const health = await Health.getSystemHealth();

// ุฅุญุตุงุฆูุงุช ุงูุฃุฏุงุก
const metrics = await Performance.getPerformanceMetrics(7);

// ุงูุงุณุชุนูุงูุงุช ุงูุจุทูุฆุฉ
const slowQueries = await Performance.getSlowQueriesReport(20);
```

## ๐ ูุฑุงูุจุฉ ุงูุฃุฏุงุก

### ููุญุฉ ูุฑุงูุจุฉ ุงูุฃุฏุงุก

```typescript
// ูุซุงู ุนูู ุงุณุชุฎุฏุงู ูุฑุงูุจ ุงูุฃุฏุงุก
import { performanceMonitor } from './utils/performance';

const result = await performanceMonitor.monitorQuery(
  'custom-query',
  async () => {
    // ุงุณุชุนูุงูู ููุง
    return await supabase.from('table').select('*');
  }
);
```

### ุฅุนุฏุงุฏุงุช ุงูุชุฎุฒูู ุงููุคูุช

```typescript
import { CacheManager } from './utils/performance';

// ุญูุธ ูู ุงููุงุด
CacheManager.set('key', data, 300000); // 5 ุฏูุงุฆู

// ุงุณุชุฑุฌุงุน ูู ุงููุงุด
const cached = CacheManager.get('key');

// ุฅุญุตุงุฆูุงุช ุงููุงุด
const stats = CacheManager.getStats();
```

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดุงูู ุดุงุฆุนุฉ ูุญููููุง

#### 1. ุงุณุชุนูุงูุงุช ุจุทูุฆุฉ
```sql
-- ูุญุต ุงูุงุณุชุนูุงูุงุช ุงูุจุทูุฆุฉ
SELECT query_type, AVG(execution_time_ms) as avg_time
FROM performance_logs 
WHERE created_at >= NOW() - INTERVAL '24 hours'
GROUP BY query_type
ORDER BY avg_time DESC;
```

#### 2. ุงุณุชููุงู ุฐุงูุฑุฉ ุนุงูู
```typescript
import { MemoryMonitor } from './utils/performance';

const memoryStatus = MemoryMonitor.checkMemoryUsage();
if (memoryStatus.warning) {
  MemoryMonitor.forceGarbageCollection();
}
```

#### 3. ูุดุงูู ุงููุงุด
```typescript
// ุชูุธูู ุงููุงุด
CacheManager.cleanup();

// ูุณุญ ุงููุงุด ุจุงููุงูู
CacheManager.clear();
```

## ๐ ูุงุฆูุฉ ุงูุชุญูู ููุตูุงูุฉ

### ููููุงู:
- [ ] ูุญุต ุตุญุฉ ุงููุธุงู: `Health.getSystemHealth()`
- [ ] ูุฑุงุฌุนุฉ ุงูุงุณุชุนูุงูุงุช ุงูุจุทูุฆุฉ
- [ ] ุชูุธูู ุงููุงุด ุงูุชููุงุฆู

### ุฃุณุจูุนูุงู:
- [ ] ุชุญุฏูุซ Materialized Views: `SELECT refresh_all_materialized_views();`
- [ ] ุชูุธูู ุณุฌูุงุช ุงูุฃุฏุงุก ุงููุฏููุฉ
- [ ] ูุฑุงุฌุนุฉ ุฅุญุตุงุฆูุงุช ุงูุฃุฏุงุก

### ุดูุฑูุงู:
- [ ] ุชุญููู ุงูุฌุฏุงูู: `ANALYZE table_name;`
- [ ] ูุฑุงุฌุนุฉ ุงูููุงุฑุณ ุบูุฑ ุงููุณุชุฎุฏูุฉ
- [ ] ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ๐ฏ ุฃูุถู ุงูููุงุฑุณุงุช

### 1. ุงุณุชุฎุฏุงู API ุงููุญุณูุฉ
```typescript
// โ ุตุญูุญ - ุงุณุชุฎุฏุงู API ูุญุณูุฉ
import { Orders, Customers } from './api/optimized-api';

// โ ุฎุทุฃ - ุงุณุชุฎุฏุงู API ูุฏููุฉ ูุจุงุดุฑุฉ
import { OrdersAPI } from './api/orders';
```

### 2. ุงูุชุญููู ุงูุชุฏุฑูุฌู
```typescript
// โ ุตุญูุญ - ุชุญููู ุฃุณุงุณู ุฃููุงู
const orders = await Orders.getOrders(filters, page, limit, false);

// ุชุญููู ุงูุชูุงุตูู ุนูุฏ ุงูุญุงุฌุฉ ููุท
if (needDetails) {
  const orderDetails = await Orders.getOrderById(orderId);
}
```

### 3. ุงุณุชุฎุฏุงู ุงููุงุด ุจุฐูุงุก
```typescript
// โ ุตุญูุญ - ูุงุด ูุตูุฑ ุงููุฏู ููุจูุงูุงุช ุงููุชุบูุฑุฉ
CacheManager.set('orders', data, 120000); // ุฏูููุชุงู

// โ ุตุญูุญ - ูุงุด ุทููู ุงููุฏู ููุจูุงูุงุช ุงูุซุงุจุชุฉ
CacheManager.set('services', data, 3600000); // ุณุงุนุฉ
```

### 4. ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุจุงูุฏูุนุงุช
```typescript
// โ ุตุญูุญ - ูุนุงูุฌุฉ ุจุงูุฏูุนุงุช
await BatchProcessor.processBatch(
  largeDataset,
  100, // ุญุฌู ุงูุฏูุนุฉ
  async (batch) => {
    // ูุนุงูุฌุฉ ุงูุฏูุนุฉ
    return await processItems(batch);
  }
);
```

## ๐จ ุชุญุฐูุฑุงุช ูููุฉ

1. **ูุง ุชุดุบู ุณูุฑูุจุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ุณุงุนุงุช ุงูุฐุฑูุฉ**
2. **ุฑุงูุจ ุงุณุชููุงู ุงูุฐุงูุฑุฉ ุนูุฏ ุงูุชุนุงูู ูุน ุงูุจูุงูุงุช ุงูุถุฎูุฉ**
3. **ุงุณุชุฎุฏู ุงูุชุญููู ุงูุชุฏุฑูุฌู ูุชุฌูุจ ุชุญููู ุจูุงูุงุช ุบูุฑ ุถุฑูุฑูุฉ**
4. **ูุธู ุงููุงุด ุจุงูุชุธุงู ูุชุฌูุจ ุงุณุชููุงู ุงูุฐุงูุฑุฉ**
5. **ุฑุงูุจ ุงูุงุณุชุนูุงูุงุช ุงูุจุทูุฆุฉ ูุญุณููุง ุนูุฏ ุงูุญุงุฌุฉ**

## ๐ ุงูุฏุนู ูุงููุณุงุนุฏุฉ

ูู ุญุงูุฉ ููุงุฌูุฉ ูุดุงูู ูู ุงูุฃุฏุงุก:

1. ุชุญูู ูู ุตุญุฉ ุงููุธุงู: `Health.getSystemHealth()`
2. ุฑุงุฌุน ุณุฌูุงุช ุงูุฃุฏุงุก: `Performance.getSlowQueriesReport()`
3. ุชุญูู ูู ุงุณุชููุงู ุงูุฐุงูุฑุฉ: `MemoryMonitor.checkMemoryUsage()`
4. ูุธู ุงูุจูุงูุงุช ุงููุฏููุฉ: `Performance.cleanupPerformanceLogs()`

---

## ๐ ููุฎุต ุงูุชุญุณููุงุช

โ **ููุชูู**: ุณูุฑูุจุช ุชุญุณูู ูุงุนุฏุฉ ุงูุจูุงูุงุช  
โ **ููุชูู**: ุชุญุณูู API ููุทูุจุงุช ูุงูุนููุงุก ูุงูุชูุงุฑูุฑ  
โ **ููุชูู**: ุฃุฏูุงุช ูุฑุงูุจุฉ ุงูุฃุฏุงุก ูุงูุชุฎุฒูู ุงููุคูุช  
โ **ููุชูู**: API ูุญุณูุฉ ูุน ูุนุงูุฌุฉ ุงูุฏูุนุงุช  
โ **ููุชูู**: ุฏููู ุงูุงุณุชุฎุฏุงู ูุงูุตูุงูุฉ  

**ุงููุชูุฌุฉ**: ุงููุธุงู ุงูุขู ุฌุงูุฒ ููุชุนุงูู ูุน ูุฆุงุช ุงูุขูุงู ูู ุงูุณุฌูุงุช ุจุฃุฏุงุก ุนุงูู ููุณุชูุฑ! ๐
