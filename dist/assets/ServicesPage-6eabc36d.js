import{c as L,r as l,j as e,W as $,X as j,L as q,V as b}from"./index-ea234c37.js";import{S as _}from"./services-7655621d.js";import{T as M}from"./tag-e5235c04.js";import{C as g}from"./check-circle-6e435bc4.js";import{G as P}from"./globe-7b95db56.js";import{F as B}from"./file-text-61c3be99.js";import{D as E}from"./dollar-sign-6405c3b9.js";import{C as F}from"./clock-726c4fbb.js";import{S as T}from"./save-364108a6.js";import{D as z}from"./DeleteConfirmModal-a9e4b9ca.js";import{P as A,T as V}from"./trash-2-1b0f85d5.js";import{P as G}from"./pen-square-9a9a872d.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=L("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),O=({isOpen:d,onClose:N,onSuccess:S,service:n,mode:h,categories:C})=>{const[r,p]=l.useState({category_id:"",name:"",name_ar:"",description:"",price:0,unit:"",estimated_duration:void 0}),[c,f]=l.useState(!1),[s,o]=l.useState({}),[i,y]=l.useState({});l.useEffect(()=>{p(n&&h==="edit"?{category_id:n.category_id||"",name:n.name||"",name_ar:n.name_ar||"",description:n.description||"",price:n.price||0,unit:n.unit||"",estimated_duration:n.estimated_duration||void 0}:{category_id:"",name:"",name_ar:"",description:"",price:0,unit:"",estimated_duration:void 0}),o({})},[n,h,d]);const k=()=>{const a={};return r.category_id||(a.category_id="فئة الخدمة مطلوبة"),r.name.trim()||(a.name="اسم الخدمة بالإنجليزية مطلوب"),r.name_ar.trim()||(a.name_ar="اسم الخدمة بالعربية مطلوب"),(!r.price||r.price<=0)&&(a.price="السعر مطلوب ويجب أن يكون أكبر من صفر"),r.unit.trim()||(a.unit="وحدة القياس مطلوبة"),a},D=async a=>{a.preventDefault();const t=k();if(o(t),!(Object.keys(t).length>0)){f(!0);try{h==="create"?(await _.createService(r),b.success("تم إضافة الخدمة بنجاح")):(await _.updateService(n.id,r),b.success("تم تحديث بيانات الخدمة بنجاح")),S(),N()}catch(u){b.error("حدث خطأ أثناء حفظ البيانات"),console.error("Service form error:",u)}finally{f(!1)}}},m=a=>{const{name:t,value:u,type:v}=a.target;p(w=>({...w,[t]:v==="number"?u===""?void 0:parseFloat(u)||0:u})),y(w=>({...w,[t]:!0})),s[t]&&o(w=>({...w,[t]:""}))},x=a=>{const{name:t}=a.target;y(v=>({...v,[t]:!0}));const u=k();u[t]&&o(v=>({...v,[t]:u[t]}))};return d?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto transform animate-slide-in border border-gray-100",children:[e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary-500 via-primary-600 to-primary-700"}),e.jsxs("div",{className:"relative flex items-center justify-between p-6 text-white",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-white/20 backdrop-blur-sm rounded-xl ml-3 shadow-lg border border-white/30",children:e.jsx($,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:h==="create"?"إضافة خدمة جديدة":"تعديل بيانات الخدمة"}),e.jsx("p",{className:"text-primary-100 text-sm mt-1",children:h==="create"?"أدخل بيانات الخدمة الجديدة":"قم بتعديل بيانات الخدمة"})]})]}),e.jsx("button",{onClick:N,className:"p-2 hover:bg-white/20 rounded-lg transition-all duration-200 hover:scale-110 border border-white/30",children:e.jsx(j,{className:"h-5 w-5 text-white"})})]})]}),e.jsxs("form",{onSubmit:D,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center label label-required text-gray-700 font-medium",children:[e.jsx(M,{className:"h-4 w-4 ml-2 text-primary-500"}),"فئة الخدمة"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"category_id",value:r.category_id,onChange:m,onBlur:x,className:`input transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 pl-10 ${s.category_id?"input-error border-red-500 focus:ring-red-500":"hover:border-primary-300"} ${i.category_id&&!s.category_id&&r.category_id?"border-green-500 focus:ring-green-500":""}`,disabled:c,children:[e.jsx("option",{value:"",children:"اختر فئة الخدمة"}),C.map(a=>e.jsx("option",{value:a.id,children:a.name_ar},a.id))]}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:i.category_id&&!s.category_id&&r.category_id?e.jsx(g,{className:"h-4 w-4 text-green-500"}):e.jsx(M,{className:"h-4 w-4 text-gray-400"})})]}),s.category_id&&e.jsxs("p",{className:"text-sm text-red-600 mt-1 animate-bounce-in flex items-center",children:[e.jsx(j,{className:"h-3 w-3 ml-1"}),s.category_id]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center label label-required text-gray-700 font-medium",children:[e.jsx($,{className:"h-4 w-4 ml-2 text-primary-500"}),"اسم الخدمة (عربي)"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",name:"name_ar",value:r.name_ar,onChange:m,onBlur:x,className:`input transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 pl-10 ${s.name_ar?"input-error border-red-500 focus:ring-red-500":"hover:border-primary-300"} ${i.name_ar&&!s.name_ar&&r.name_ar?"border-green-500 focus:ring-green-500":""}`,placeholder:"أدخل اسم الخدمة بالعربية",disabled:c}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:i.name_ar&&!s.name_ar&&r.name_ar?e.jsx(g,{className:"h-4 w-4 text-green-500"}):e.jsx($,{className:"h-4 w-4 text-gray-400"})})]}),s.name_ar&&e.jsxs("p",{className:"text-sm text-red-600 mt-1 animate-bounce-in flex items-center",children:[e.jsx(j,{className:"h-3 w-3 ml-1"}),s.name_ar]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center label label-required text-gray-700 font-medium",children:[e.jsx(P,{className:"h-4 w-4 ml-2 text-primary-500"}),"اسم الخدمة (إنجليزي)"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",name:"name",value:r.name,onChange:m,onBlur:x,className:`input transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 pl-10 ${s.name?"input-error border-red-500 focus:ring-red-500":"hover:border-primary-300"} ${i.name&&!s.name&&r.name?"border-green-500 focus:ring-green-500":""}`,placeholder:"Enter service name in English",disabled:c}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:i.name&&!s.name&&r.name?e.jsx(g,{className:"h-4 w-4 text-green-500"}):e.jsx(P,{className:"h-4 w-4 text-gray-400"})})]}),s.name&&e.jsxs("p",{className:"text-sm text-red-600 mt-1 animate-bounce-in flex items-center",children:[e.jsx(j,{className:"h-3 w-3 ml-1"}),s.name]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center label text-gray-700 font-medium",children:[e.jsx(B,{className:"h-4 w-4 ml-2 text-primary-500"}),"وصف الخدمة"]}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{name:"description",value:r.description,onChange:m,onBlur:x,className:`input transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 hover:border-primary-300 pl-10 ${i.description&&r.description?"border-green-500 focus:ring-green-500":""}`,placeholder:"أدخل وصف الخدمة (اختياري)",rows:3,disabled:c}),e.jsx("div",{className:"absolute left-3 top-3",children:i.description&&r.description?e.jsx(g,{className:"h-4 w-4 text-green-500"}):e.jsx(B,{className:"h-4 w-4 text-gray-400"})})]}),r.description&&e.jsxs("p",{className:"text-xs text-gray-500",children:[r.description.length," حرف"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center label label-required text-gray-700 font-medium",children:[e.jsx(E,{className:"h-4 w-4 ml-2 text-primary-500"}),"السعر (ج.م)"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",name:"price",value:r.price,onChange:m,onBlur:x,className:`input transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 pl-10 ${s.price?"input-error border-red-500 focus:ring-red-500":"hover:border-primary-300"} ${i.price&&!s.price&&r.price>0?"border-green-500 focus:ring-green-500":""}`,placeholder:"0.00",min:"0",step:"0.01",disabled:c}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:i.price&&!s.price&&r.price>0?e.jsx(g,{className:"h-4 w-4 text-green-500"}):e.jsx(E,{className:"h-4 w-4 text-gray-400"})})]}),s.price&&e.jsxs("p",{className:"text-sm text-red-600 mt-1 animate-bounce-in flex items-center",children:[e.jsx(j,{className:"h-3 w-3 ml-1"}),s.price]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center label label-required text-gray-700 font-medium",children:[e.jsx(M,{className:"h-4 w-4 ml-2 text-primary-500"}),"وحدة القياس"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"unit",value:r.unit,onChange:m,onBlur:x,className:`input transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 pl-10 ${s.unit?"input-error border-red-500 focus:ring-red-500":"hover:border-primary-300"} ${i.unit&&!s.unit&&r.unit?"border-green-500 focus:ring-green-500":""}`,disabled:c,children:[e.jsx("option",{value:"",children:"اختر وحدة القياس"}),e.jsx("option",{value:"غرفة",children:"غرفة"}),e.jsx("option",{value:"متر مربع",children:"متر مربع"}),e.jsx("option",{value:"ساعة",children:"ساعة"}),e.jsx("option",{value:"قطعة",children:"قطعة"}),e.jsx("option",{value:"مرة واحدة",children:"مرة واحدة"})]}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:i.unit&&!s.unit&&r.unit?e.jsx(g,{className:"h-4 w-4 text-green-500"}):e.jsx(M,{className:"h-4 w-4 text-gray-400"})})]}),s.unit&&e.jsxs("p",{className:"text-sm text-red-600 mt-1 animate-bounce-in flex items-center",children:[e.jsx(j,{className:"h-3 w-3 ml-1"}),s.unit]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center label text-gray-700 font-medium",children:[e.jsx(F,{className:"h-4 w-4 ml-2 text-primary-500"}),"المدة المتوقعة (دقيقة)"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",name:"estimated_duration",value:r.estimated_duration||"",onChange:m,onBlur:x,className:`input transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 hover:border-primary-300 pl-10 ${i.estimated_duration&&r.estimated_duration&&r.estimated_duration>0?"border-green-500 focus:ring-green-500":""}`,placeholder:"0",min:"0",disabled:c}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:i.estimated_duration&&r.estimated_duration&&r.estimated_duration>0?e.jsx(g,{className:"h-4 w-4 text-green-500"}):e.jsx(F,{className:"h-4 w-4 text-gray-400"})})]}),r.estimated_duration&&r.estimated_duration>0&&e.jsxs("p",{className:"text-xs text-gray-500",children:["المدة المتوقعة: ",Math.floor(r.estimated_duration/60)," ساعة و ",r.estimated_duration%60," دقيقة"]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 space-x-reverse pt-6 border-t border-gray-100",children:[e.jsx("button",{type:"button",onClick:N,className:"px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 font-medium focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",disabled:c,children:"إلغاء"}),e.jsx("button",{type:"submit",className:"px-6 py-2.5 bg-gradient-to-r from-primary-500 to-primary-600 text-white rounded-lg hover:from-primary-600 hover:to-primary-700 transition-all duration-200 font-medium shadow-lg hover:shadow-xl transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",disabled:c,children:c?e.jsxs("div",{className:"flex items-center",children:[e.jsx(q,{size:"small"}),e.jsx("span",{className:"mr-2",children:"جاري الحفظ..."})]}):e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{className:"h-4 w-4 ml-2"}),h==="create"?"إضافة الخدمة":"حفظ التغييرات"]})})]})]})]})}):null},re=()=>{const[d,N]=l.useState([]),[S,n]=l.useState([]),[h,C]=l.useState(!0),[r,p]=l.useState(!1),[c,f]=l.useState(!1),[s,o]=l.useState(),[i,y]=l.useState("create"),[k,D]=l.useState(!1);l.useEffect(()=>{m()},[]);const m=async()=>{try{C(!0);const[a,t]=await Promise.all([_.getServices(),_.getServiceCategories()]);N(a),n(t)}catch(a){b.error("حدث خطأ في تحميل الخدمات"),console.error("Services fetch error:",a)}finally{C(!1)}},x=async()=>{if(s){D(!0);try{await _.deleteService(s.id),b.success("تم حذف الخدمة بنجاح"),f(!1),o(void 0),m()}catch(a){b.error("حدث خطأ أثناء حذف الخدمة"),console.error("Delete service error:",a)}finally{D(!1)}}};return h?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(q,{size:"large",text:"جاري تحميل الخدمات..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-primary-600 to-primary-800 bg-clip-text text-transparent",children:"إدارة الخدمات"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"إدارة الخدمات والأسعار"})]}),e.jsxs("button",{onClick:()=>{o(void 0),y("create"),p(!0)},className:"btn-primary hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl",children:[e.jsx(A,{className:"h-5 w-5 ml-2"}),"إضافة خدمة جديدة"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card-compact bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:"إجمالي الخدمات"}),e.jsx("p",{className:"text-2xl font-bold text-blue-800",children:d.length})]}),e.jsx("div",{className:"p-3 bg-blue-500 rounded-lg",children:e.jsx($,{className:"h-6 w-6 text-white"})})]})}),e.jsx("div",{className:"card-compact bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:"متوسط السعر"}),e.jsxs("p",{className:"text-2xl font-bold text-green-800",children:[d.length>0?Math.round(d.reduce((a,t)=>a+t.price,0)/d.length):0," ج.م"]})]}),e.jsx("div",{className:"p-3 bg-green-500 rounded-lg",children:e.jsx(E,{className:"h-6 w-6 text-white"})})]})}),e.jsx("div",{className:"card-compact bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-600",children:"الفئات"}),e.jsx("p",{className:"text-2xl font-bold text-purple-800",children:S.length})]}),e.jsx("div",{className:"p-3 bg-purple-500 rounded-lg",children:e.jsx(I,{className:"h-6 w-6 text-white"})})]})}),e.jsx("div",{className:"card-compact bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-600",children:"متوسط المدة"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-800",children:[d.length>0&&Math.round(d.filter(a=>a.estimated_duration).reduce((a,t)=>a+(t.estimated_duration||0),0)/d.filter(a=>a.estimated_duration).length)||0," د"]})]}),e.jsx("div",{className:"p-3 bg-orange-500 rounded-lg",children:e.jsx(F,{className:"h-6 w-6 text-white"})})]})})]}),e.jsx("div",{className:"card-elevated",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"table-header",children:e.jsxs("tr",{children:[e.jsx("th",{className:"table-header-cell",children:"اسم الخدمة"}),e.jsx("th",{className:"table-header-cell",children:"الفئة"}),e.jsx("th",{className:"table-header-cell",children:"السعر"}),e.jsx("th",{className:"table-header-cell",children:"الوحدة"}),e.jsx("th",{className:"table-header-cell",children:"المدة المتوقعة"}),e.jsx("th",{className:"table-header-cell",children:"الإجراءات"})]})}),e.jsx("tbody",{className:"table-body",children:d.map(a=>{var t;return e.jsxs("tr",{className:"table-row",children:[e.jsx("td",{className:"table-cell font-medium",children:a.name_ar}),e.jsx("td",{className:"table-cell",children:(t=a.category)==null?void 0:t.name_ar}),e.jsxs("td",{className:"table-cell",children:[a.price," ج.م"]}),e.jsx("td",{className:"table-cell",children:a.unit}),e.jsx("td",{className:"table-cell",children:a.estimated_duration?`${a.estimated_duration} دقيقة`:"غير محدد"}),e.jsx("td",{className:"table-cell",children:e.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[e.jsx("button",{onClick:()=>{o(a),y("edit"),p(!0)},className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 hover:scale-110 shadow-sm hover:shadow-md",title:"تعديل",children:e.jsx(G,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>{o(a),f(!0)},className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 hover:scale-110 shadow-sm hover:shadow-md",title:"حذف",children:e.jsx(V,{className:"h-4 w-4"})})]})})]},a.id)})})]})})}),e.jsx(O,{isOpen:r,onClose:()=>{p(!1),o(void 0)},onSuccess:()=>{m()},service:s,mode:i,categories:S}),e.jsx(z,{isOpen:c,onClose:()=>{f(!1),o(void 0)},onConfirm:x,title:"حذف الخدمة",message:"هل أنت متأكد من رغبتك في حذف هذه الخدمة؟ قد يؤثر ذلك على الطلبات المرتبطة بها.",itemName:s==null?void 0:s.name_ar,loading:k})]})};export{re as default};
