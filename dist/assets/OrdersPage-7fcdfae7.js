import{c as Z,r as o,u as ee,V as _,j as e,S as le,X as O,L as z,d as $}from"./index-ea234c37.js";import{O as A}from"./orders-a172bcdc.js";import{C as ie}from"./customers-ac821874.js";import{S as ce}from"./services-7655621d.js";import{T as de}from"./workers-57d60f20.js";import{C as P}from"./check-circle-6e435bc4.js";import{C as V}from"./calendar-0d424678.js";import{C as X}from"./clock-726c4fbb.js";import{P as G,T as ne}from"./trash-2-1b0f85d5.js";import{D as R}from"./dollar-sign-6405c3b9.js";import{F as U}from"./file-text-61c3be99.js";import{S as oe}from"./save-364108a6.js";import{D as me}from"./DeleteConfirmModal-a9e4b9ca.js";import{u as he}from"./useQuery-c20e633a.js";import{P as Q}from"./play-d145c3c0.js";import{C as J}from"./check-dd756ef7.js";import{X as K}from"./x-circle-8e3ae07f.js";import{S as ue}from"./search-90baa635.js";import{E as xe}from"./eye-5494d1ef.js";import{P as pe}from"./pen-square-9a9a872d.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=Z("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=Z("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);var T=(m=>(m.PENDING="pending",m.SCHEDULED="scheduled",m.IN_PROGRESS="in_progress",m.COMPLETED="completed",m.CANCELLED="cancelled",m))(T||{});const ge=({isOpen:m,onClose:p,onSuccess:B,order:h,mode:j})=>{const[s,u]=o.useState({customer_id:"",scheduled_date:"",scheduled_time:"",services:[{service_id:"",quantity:1}],team_id:"",payment_status:"unpaid",payment_method:"cash",transport_method:"company_car",notes:""}),[F,E]=o.useState([]),[k,M]=o.useState([]),[f,w]=o.useState([]),[c,L]=o.useState(!1),[I,q]=o.useState(!0),[i,C]=o.useState({}),[d,S]=o.useState({}),{user:a}=ee();o.useEffect(()=>{m&&x()},[m]),o.useEffect(()=>{var t;u(h&&j==="edit"?{customer_id:h.customer_id,scheduled_date:h.scheduled_date,scheduled_time:h.scheduled_time,services:((t=h.items)==null?void 0:t.map(r=>({service_id:r.service_id,quantity:r.quantity})))||[{service_id:"",quantity:1}],team_id:h.team_id||"",payment_status:h.payment_status||"unpaid",payment_method:h.payment_method||"cash",transport_method:h.transport_method||"company_car",notes:h.notes||""}:{customer_id:"",scheduled_date:"",scheduled_time:"",services:[{service_id:"",quantity:1}],team_id:"",payment_status:"unpaid",payment_method:"cash",transport_method:"company_car",notes:""}),C({})},[h,j,m]);const x=async()=>{try{q(!0);const[t,r,l]=await Promise.all([ie.getCustomers(),ce.getServices(),de.getTeams()]);E(t.data),M(r),w(l)}catch(t){_.error("حدث خطأ في تحميل البيانات"),console.error("Order form data fetch error:",t)}finally{q(!1)}},g=()=>{const t={};return s.customer_id||(t.customer_id="العميل مطلوب"),s.scheduled_date||(t.scheduled_date="تاريخ الخدمة مطلوب"),s.scheduled_time||(t.scheduled_time="وقت الخدمة مطلوب"),s.services.length===0?t.services="يجب إضافة خدمة واحدة على الأقل":s.services.some(l=>!l.service_id)&&(t.services="يجب اختيار جميع الخدمات"),C(t),Object.keys(t).length===0},b=async t=>{if(t.preventDefault(),!!g()){L(!0);try{if(j==="create"){const r={customer_id:s.customer_id,scheduled_date:s.scheduled_date,scheduled_time:s.scheduled_time,team_id:s.team_id||null,payment_status:s.payment_status,payment_method:s.payment_method,transport_method:s.transport_method,notes:s.notes,created_by:(a==null?void 0:a.id)||void 0},l=s.services.map(N=>{const D=k.find(re=>re.id===N.service_id);return{service_id:N.service_id,quantity:N.quantity,unit_price:(D==null?void 0:D.price)||0,total_price:((D==null?void 0:D.price)||0)*N.quantity}}),n=await A.createOrder(r,l);if(n.success)_.success("تم إضافة الطلب بنجاح");else throw new Error(n.error||"Create order failed")}else await A.updateOrder(h.id,s),_.success("تم تحديث بيانات الطلب بنجاح");B(),p()}catch(r){_.error(r.message||"حدث خطأ أثناء حفظ البيانات"),console.error("Order form error:",r)}finally{L(!1)}}},v=t=>{const{name:r,value:l}=t.target;u(n=>({...n,[r]:l})),S(n=>({...n,[r]:!0})),i[r]&&C(n=>({...n,[r]:""}))},y=t=>{const{name:r}=t.target;S(l=>({...l,[r]:!0}))},H=(t,r,l)=>{const n=[...s.services];n[t]={...n[t],[r]:l},u(N=>({...N,services:n})),i.services&&C(N=>({...N,services:""}))},se=()=>{u(t=>({...t,services:[...t.services,{service_id:"",quantity:1}]}))},te=t=>{if(s.services.length>1){const r=s.services.filter((l,n)=>n!==t);u(l=>({...l,services:r}))}},ae=()=>s.services.reduce((t,r)=>{const l=k.find(n=>n.id===r.service_id);return t+(l?l.price*r.quantity:0)},0);return m?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto transform animate-slide-in border border-gray-100",children:[e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary-500 via-primary-600 to-primary-700"}),e.jsxs("div",{className:"relative flex items-center justify-between p-6 text-white",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-white/20 backdrop-blur-sm rounded-xl ml-3 shadow-lg border border-white/30",children:e.jsx(le,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:j==="create"?"إضافة طلب جديد":"تعديل بيانات الطلب"}),e.jsx("p",{className:"text-primary-100 text-sm mt-1",children:j==="create"?"أدخل بيانات الطلب الجديد":"قم بتعديل بيانات الطلب"})]})]}),e.jsx("button",{onClick:p,className:"p-2 hover:bg-white/20 rounded-lg transition-all duration-200 hover:scale-110 border border-white/30",children:e.jsx(O,{className:"h-5 w-5 text-white"})})]})]}),I?e.jsx("div",{className:"p-8 flex justify-center",children:e.jsx(z,{size:"large",text:"جاري تحميل البيانات..."})}):e.jsxs("form",{onSubmit:b,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center label label-required text-gray-700 font-medium",children:[e.jsx($,{className:"h-4 w-4 ml-2 text-primary-500"}),"العميل"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"customer_id",value:s.customer_id,onChange:v,onBlur:y,className:`input transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 pl-10 ${i.customer_id?"input-error border-red-500 focus:ring-red-500":"hover:border-primary-300"} ${d.customer_id&&!i.customer_id&&s.customer_id?"border-green-500 focus:ring-green-500":""}`,disabled:c,children:[e.jsx("option",{value:"",children:"اختر العميل"}),F.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",t.phone]},t.id))]}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:d.customer_id&&!i.customer_id&&s.customer_id?e.jsx(P,{className:"h-4 w-4 text-green-500"}):e.jsx($,{className:"h-4 w-4 text-gray-400"})})]}),i.customer_id&&e.jsxs("p",{className:"text-sm text-red-600 mt-1 animate-bounce-in flex items-center",children:[e.jsx(O,{className:"h-3 w-3 ml-1"}),i.customer_id]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center label label-required text-gray-700 font-medium",children:[e.jsx(V,{className:"h-4 w-4 ml-2 text-primary-500"}),"تاريخ الخدمة"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",name:"scheduled_date",value:s.scheduled_date,onChange:v,onBlur:y,className:`input transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 pl-10 ${i.scheduled_date?"input-error border-red-500 focus:ring-red-500":"hover:border-primary-300"} ${d.scheduled_date&&!i.scheduled_date&&s.scheduled_date?"border-green-500 focus:ring-green-500":""}`,min:new Date().toISOString().split("T")[0],disabled:c}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:d.scheduled_date&&!i.scheduled_date&&s.scheduled_date?e.jsx(P,{className:"h-4 w-4 text-green-500"}):e.jsx(V,{className:"h-4 w-4 text-gray-400"})})]}),i.scheduled_date&&e.jsxs("p",{className:"text-sm text-red-600 mt-1 animate-bounce-in flex items-center",children:[e.jsx(O,{className:"h-3 w-3 ml-1"}),i.scheduled_date]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center label label-required text-gray-700 font-medium",children:[e.jsx(X,{className:"h-4 w-4 ml-2 text-primary-500"}),"وقت الخدمة"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"time",name:"scheduled_time",value:s.scheduled_time,onChange:v,onBlur:y,className:`input transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 pl-10 ${i.scheduled_time?"input-error border-red-500 focus:ring-red-500":"hover:border-primary-300"} ${d.scheduled_time&&!i.scheduled_time&&s.scheduled_time?"border-green-500 focus:ring-green-500":""}`,disabled:c}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:d.scheduled_time&&!i.scheduled_time&&s.scheduled_time?e.jsx(P,{className:"h-4 w-4 text-green-500"}):e.jsx(X,{className:"h-4 w-4 text-gray-400"})})]}),i.scheduled_time&&e.jsxs("p",{className:"text-sm text-red-600 mt-1 animate-bounce-in flex items-center",children:[e.jsx(O,{className:"h-3 w-3 ml-1"}),i.scheduled_time]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"label label-required",children:"الخدمات المطلوبة"}),e.jsxs("button",{type:"button",onClick:se,className:"btn-secondary text-sm",disabled:c,children:[e.jsx(G,{className:"h-4 w-4 ml-1"}),"إضافة خدمة"]})]}),e.jsx("div",{className:"space-y-3",children:s.services.map((t,r)=>e.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse p-3 border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("select",{value:t.service_id,onChange:l=>H(r,"service_id",l.target.value),className:"input",disabled:c,children:[e.jsx("option",{value:"",children:"اختر الخدمة"}),k.map(l=>e.jsxs("option",{value:l.id,children:[l.name_ar," - ",l.price," ج.م/",l.unit]},l.id))]})}),e.jsx("div",{className:"w-24",children:e.jsx("input",{type:"number",value:t.quantity,onChange:l=>H(r,"quantity",parseInt(l.target.value)||1),className:"input text-center",min:"1",disabled:c})}),s.services.length>1&&e.jsx("button",{type:"button",onClick:()=>te(r),className:"p-2 text-red-600 hover:bg-red-50 rounded",disabled:c,children:e.jsx(ne,{className:"h-4 w-4"})})]},r))}),i.services&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:i.services}),e.jsx("div",{className:"mt-4 p-4 bg-gradient-to-r from-primary-50 to-primary-100 rounded-xl border border-primary-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{className:"h-5 w-5 text-primary-600 ml-2"}),e.jsx("span",{className:"font-medium text-gray-700",children:"إجمالي المبلغ:"})]}),e.jsxs("span",{className:"text-xl font-bold text-primary-600 bg-white px-3 py-1 rounded-lg shadow-sm",children:[ae().toFixed(2)," ج.م"]})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center label text-gray-700 font-medium",children:[e.jsx($,{className:"h-4 w-4 ml-2 text-primary-500"}),"الفريق (اختياري)"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"team_id",value:s.team_id,onChange:v,onBlur:y,className:`input transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 hover:border-primary-300 pl-10 ${d.team_id&&s.team_id?"border-green-500 focus:ring-green-500":""}`,disabled:c,children:[e.jsx("option",{value:"",children:"غير محدد"}),f.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:d.team_id&&s.team_id?e.jsx(P,{className:"h-4 w-4 text-green-500"}):e.jsx($,{className:"h-4 w-4 text-gray-400"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center label text-gray-700 font-medium",children:[e.jsx(Y,{className:"h-4 w-4 ml-2 text-primary-500"}),"وسيلة المواصلات"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"transport_method",value:s.transport_method,onChange:v,onBlur:y,className:`input transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 hover:border-primary-300 pl-10 ${d.transport_method&&s.transport_method?"border-green-500 focus:ring-green-500":""}`,disabled:c,children:[e.jsx("option",{value:"company_car",children:"سيارة الشركة"}),e.jsx("option",{value:"taxi",children:"تاكسي"}),e.jsx("option",{value:"uber",children:"أوبر"}),e.jsx("option",{value:"public_transport",children:"مواصلات عامة"})]}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:e.jsx(Y,{className:"h-4 w-4 text-gray-400"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center label text-gray-700 font-medium",children:[e.jsx(W,{className:"h-4 w-4 ml-2 text-primary-500"}),"حالة الدفع"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"payment_status",value:s.payment_status,onChange:v,onBlur:y,className:`input transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 hover:border-primary-300 pl-10 ${d.payment_status&&s.payment_status?"border-green-500 focus:ring-green-500":""}`,disabled:c,children:[e.jsx("option",{value:"unpaid",children:"غير مدفوع"}),e.jsx("option",{value:"paid_cash",children:"مدفوع نقدًا"}),e.jsx("option",{value:"paid_card",children:"مدفوع بالبطاقة"})]}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:e.jsx(W,{className:"h-4 w-4 text-gray-400"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center label text-gray-700 font-medium",children:[e.jsx(R,{className:"h-4 w-4 ml-2 text-primary-500"}),"طريقة الدفع"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"payment_method",value:s.payment_method,onChange:v,onBlur:y,className:`input transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 hover:border-primary-300 pl-10 ${d.payment_method&&s.payment_method?"border-green-500 focus:ring-green-500":""}`,disabled:c,children:[e.jsx("option",{value:"cash",children:"نقدًا"}),e.jsx("option",{value:"card",children:"بطاقة"})]}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:e.jsx(R,{className:"h-4 w-4 text-gray-400"})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center label text-gray-700 font-medium",children:[e.jsx(U,{className:"h-4 w-4 ml-2 text-primary-500"}),"ملاحظات"]}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{name:"notes",value:s.notes,onChange:v,onBlur:y,className:`input transition-all duration-200 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 hover:border-primary-300 pl-10 ${d.notes&&s.notes?"border-green-500 focus:ring-green-500":""}`,placeholder:"أدخل أي ملاحظات إضافية (اختياري)",rows:3,disabled:c}),e.jsx("div",{className:"absolute left-3 top-3",children:d.notes&&s.notes?e.jsx(P,{className:"h-4 w-4 text-green-500"}):e.jsx(U,{className:"h-4 w-4 text-gray-400"})})]}),s.notes&&e.jsxs("p",{className:"text-xs text-gray-500",children:[s.notes.length," حرف"]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 space-x-reverse pt-6 border-t border-gray-100",children:[e.jsx("button",{type:"button",onClick:p,className:"px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 font-medium focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",disabled:c,children:"إلغاء"}),e.jsx("button",{type:"submit",className:"px-6 py-2.5 bg-gradient-to-r from-primary-500 to-primary-600 text-white rounded-lg hover:from-primary-600 hover:to-primary-700 transition-all duration-200 font-medium shadow-lg hover:shadow-xl transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",disabled:c,children:c?e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{size:"small"}),e.jsx("span",{className:"mr-2",children:"جاري الحفظ..."})]}):e.jsxs("div",{className:"flex items-center",children:[e.jsx(oe,{className:"h-4 w-4 ml-2"}),j==="create"?"إضافة الطلب":"حفظ التغييرات"]})})]})]})]})}):null},Ae=()=>{const{user:m}=ee(),[p,B]=o.useState(""),{data:h=[],isLoading:j,refetch:s}=he(["orders",p],()=>A.getOrders({search:p}).then(a=>a.data),{keepPreviousData:!0}),u=h,[F,E]=o.useState(!1),[k,M]=o.useState(!1),[f,w]=o.useState(),[c,L]=o.useState("create"),[I,q]=o.useState(!1),i=async()=>{f&&(q(!0),console.log("Delete order:",f.id),_.success("تم حذف الطلب بنجاح"),M(!1),w(void 0),s(),q(!1))},C=a=>{const x={pending:"status-pending",scheduled:"status-scheduled",in_progress:"status-in-progress",completed:"status-completed",cancelled:"status-cancelled"},g={pending:"معلق",scheduled:"مجدول",in_progress:"قيد التنفيذ",completed:"مكتمل",cancelled:"ملغي"},b=a==="in_progress";return e.jsx("span",{className:`badge ${x[a]||"badge-gray"} ${b?"animate-pulse":""}`,children:g[a]||a})},d=async(a,x)=>{let g;x===T.CANCELLED&&(g=window.prompt("أدخل سبب الإلغاء:")||void 0);try{_.loading("جاري تحديث حالة الطلب...",{id:"status"});const b=await A.updateOrderStatus(a.id,x,g,m==null?void 0:m.id);if(b.success)_.success("تم تحديث حالة الطلب",{id:"status"}),s();else throw new Error(b.error)}catch(b){_.error("حدث خطأ في تحديث الحالة",{id:"status"}),console.error("Status update error:",b)}},S=u.filter(a=>{var x;return a.order_number.toLowerCase().includes(p.toLowerCase())||((x=a.customer)==null?void 0:x.name.toLowerCase().includes(p.toLowerCase()))});return j?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(z,{size:"large",text:"جاري تحميل الطلبات..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-primary-600 to-primary-800 bg-clip-text text-transparent",children:"إدارة الطلبات"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"إدارة طلبات العملاء وتتبع حالتها"})]}),e.jsxs("button",{onClick:()=>{w(void 0),L("create"),E(!0)},className:"btn-primary hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl",children:[e.jsx(G,{className:"h-5 w-5 ml-2"}),"طلب جديد"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card-compact bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:"إجمالي الطلبات"}),e.jsx("p",{className:"text-2xl font-bold text-blue-800",children:u.length})]}),e.jsx("div",{className:"p-3 bg-blue-500 rounded-lg",children:e.jsx(G,{className:"h-6 w-6 text-white"})})]})}),e.jsx("div",{className:"card-compact bg-gradient-to-br from-yellow-50 to-yellow-100 border-yellow-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-600",children:"قيد الانتظار"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-800",children:u.filter(a=>a.status==="pending").length})]}),e.jsx("div",{className:"p-3 bg-yellow-500 rounded-lg",children:e.jsx(Q,{className:"h-6 w-6 text-white"})})]})}),e.jsx("div",{className:"card-compact bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:"مكتملة"}),e.jsx("p",{className:"text-2xl font-bold text-green-800",children:u.filter(a=>a.status==="completed").length})]}),e.jsx("div",{className:"p-3 bg-green-500 rounded-lg",children:e.jsx(J,{className:"h-6 w-6 text-white"})})]})}),e.jsx("div",{className:"card-compact bg-gradient-to-br from-red-50 to-red-100 border-red-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-600",children:"ملغية"}),e.jsx("p",{className:"text-2xl font-bold text-red-800",children:u.filter(a=>a.status==="cancelled").length})]}),e.jsx("div",{className:"p-3 bg-red-500 rounded-lg",children:e.jsx(K,{className:"h-6 w-6 text-white"})})]})})]}),e.jsxs("div",{className:"card-compact",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ue,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",placeholder:"البحث عن طلب برقم الطلب أو اسم العميل...",className:"input pr-10 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all duration-200",value:p,onChange:a=>B(a.target.value)})]}),p&&e.jsx("div",{className:"mt-3 p-3 bg-primary-50 rounded-lg border border-primary-200",children:e.jsxs("p",{className:"text-sm text-primary-700",children:["عرض ",S.length," من أصل ",u.length," طلب"]})})]}),e.jsx("div",{className:"card-elevated",children:e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"table-header",children:e.jsxs("tr",{children:[e.jsx("th",{className:"table-header-cell",children:"رقم الطلب"}),e.jsx("th",{className:"table-header-cell",children:"العميل"}),e.jsx("th",{className:"table-header-cell",children:"التاريخ"}),e.jsx("th",{className:"table-header-cell",children:"الوقت"}),e.jsx("th",{className:"table-header-cell",children:"الحالة"}),e.jsx("th",{className:"table-header-cell",children:"المبلغ"}),e.jsx("th",{className:"table-header-cell",children:"الفريق"}),e.jsx("th",{className:"table-header-cell",children:"الإجراءات"})]})}),e.jsx("tbody",{className:"table-body",children:S.map(a=>{var x,g;return e.jsxs("tr",{className:"table-row",children:[e.jsx("td",{className:"table-cell font-medium",children:a.order_number}),e.jsx("td",{className:"table-cell",children:(x=a.customer)==null?void 0:x.name}),e.jsx("td",{className:"table-cell",children:new Date(a.scheduled_date).toLocaleDateString("ar-AE")}),e.jsx("td",{className:"table-cell",children:a.scheduled_time}),e.jsx("td",{className:"table-cell",children:C(a.status)}),e.jsxs("td",{className:"table-cell",children:[a.total_amount," ج.م"]}),e.jsx("td",{className:"table-cell",children:((g=a.team)==null?void 0:g.name)||"غير محدد"}),e.jsx("td",{className:"table-cell",children:e.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[e.jsx("button",{className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 hover:scale-110 shadow-sm hover:shadow-md",title:"عرض التفاصيل",children:e.jsx(xe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>{w(a),L("edit"),E(!0)},className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-all duration-200 hover:scale-110 shadow-sm hover:shadow-md",title:"تعديل",children:e.jsx(pe,{className:"h-4 w-4"})}),a.status==="pending"||a.status==="scheduled"?e.jsx("button",{onClick:()=>d(a,T.IN_PROGRESS),className:"p-2 text-yellow-600 hover:bg-yellow-50 rounded-lg transition-all duration-200 hover:scale-110 shadow-sm hover:shadow-md",title:"بدء التنفيذ",children:e.jsx(Q,{className:"h-4 w-4"})}):null,a.status==="in_progress"?e.jsx("button",{onClick:()=>d(a,T.COMPLETED),className:"p-2 text-green-700 hover:bg-green-50 rounded-lg transition-all duration-200 hover:scale-110 shadow-sm hover:shadow-md",title:"إكمال",children:e.jsx(J,{className:"h-4 w-4"})}):null,a.status!=="cancelled"&&a.status!=="completed"?e.jsx("button",{onClick:()=>d(a,T.CANCELLED),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 hover:scale-110 shadow-sm hover:shadow-md",title:"إلغاء",children:e.jsx(K,{className:"h-4 w-4"})}):null]})})]},a.id)})})]}),S.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"لا توجد طلبات مطابقة للبحث"})})]})}),e.jsx(ge,{isOpen:F,onClose:()=>{E(!1),w(void 0)},onSuccess:()=>{s()},order:f,mode:c}),e.jsx(me,{isOpen:k,onClose:()=>{M(!1),w(void 0)},onConfirm:i,title:"حذف الطلب",message:"هل أنت متأكد من رغبتك في حذف هذا الطلب؟ لا يمكن التراجع عن هذا الإجراء.",itemName:f==null?void 0:f.order_number,loading:I})]})};export{Ae as default};
